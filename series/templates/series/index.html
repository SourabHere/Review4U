{% extends 'series/basic.html'%}
{% block title %} Home {% endblock %}
{%block body%}
{%load static%}
<link rel="stylesheet" href="{% static 'series/styleIndex.css' %}">

<div class="container my-4">
    <h2>WebSeries</h2>

</div>

<div class="series  my-1">

    <div class="components">
        {% for i in slist%}

        <!-- <div class="card" style="width: 38rem;" id="card{{i.series_id}}}"> -->
        <div class="card mx-1 S{{forloop.counter0}}" id="card{{i.series_id}}}">
            <!-- <img src='/media/{{i.series_img}}' class="img-fluid imgs mx-1" alt="..." style="height: 20rem;max-width: 35rem;"> -->
            <a href="/series/moredetail/{{i.series_id}}" class="linkimg" id="detail{{forloop.counter0}}"> <img
                    src='/media/{{i.series_img}}' class="img-fluid imgs mx-1" alt="..." id="Series{{forloop.counter0}}">
            </a>
            <div class="card-body mx-1">
                <h3 class="card-title head" id="name{{i.series_id}}"> <a href="/series/moredetail/{{i.series_id}}"
                        class="more">{{i.series_name}}</a> </h3>
                <p class="card-text" id="desc{{i.series_id}}">{{i.desc|slice:"0:183"}}...</p>
                <p id="rate{{i.series_id}}">{{i.rating}}/10<i class="bi bi-star-fill">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="orange"
                            class="bi bi-star-fill" viewBox="0 1 16 16">
                            <path
                                d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z" />
                        </svg>
                    </i>({{i.noOfRev}})</p>
                <a href="/series/myreview/{{i.series_id}}" class="btn btn-primary addrv" id="rev{{i.series_id}}"
                    style="background-color: rgb(233 19 19);border: 2px rgb(233 19 19);">Add my review</a>
            </div>
        </div>

        {%endfor%}
    </div>
</div>


{%endblock%}
{% block js%}
<script src="{%static 'series/scripts/index.js'%}"></script>
<!-- <script>

    //popover
    var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
    var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
        return new bootstrap.Popover(popoverTriggerEl)

    });

    let search = document.getElementById('search1');
    let searchbtn = document.getElementById('searchbtn');


    //updatePopover

    function updatePopover() {
        console.log("we are here");

        var popstr = "";
        let count = 0
        more = document.getElementsByClassName('more');
        Array.from(more).forEach(element => {
            let Sname = element.textContent;

            curclass = document.querySelector(`.S${count}`);
            originnalname = Sname;
            Sname = Sname.toLowerCase();
            // searchval = searchval.toLowerCase();
            // searchsize = searchval.length;

            Seriesimg = document.getElementById(`Series${count}`);

            detail = document.getElementById(`detail${count}`);

            // console.log("yahooo");
            // console.log(Aname);

            popstr = popstr + `<div class="card mb-3 cardrecc box${count}" style="width:auto;">
                <div class="row g-0 content${count} poparea">
                    <div class="col-md-4 popimgarea">
                        <a href="${detail.getAttribute("href")}" class="linkimg"><img src="${Seriesimg.getAttribute("src")}" class="img-fluid rounded-start popimage" alt="..."></a>
                        </div>
                        <div class="col-md-8">
                            <div class="card-body popcbody" >
                                <a href="${detail.getAttribute("href")}" class="more2"><h5 class="card-title card${count} poptitle" >${originnalname}</h5></a>
                                </div>
                                </div>
                                </div>
                                </div>`;
            search.setAttribute('data-bs-content', popstr);

            count++;
        });
        // console.log(popstr);

        search.setAttribute('data-bs-content', popstr);
        // $('#search1').popover('show');
    }

    search.addEventListener("input", function () {
        // let searchval = search.value;
        // console.log(searchval);
        let searchval = search.value.toLowerCase();
        // console.log(searchval);

        updatePopover(searchval);


        if (searchval == '') {
            // console.log("here");
            $('#search1').popover('hide');

        }
        else {
            // console.log("not here");
            $('#search1').popover('show');
        }

        let searchpop = document.getElementsByClassName("cardrecc");
        // console.log(searchpop.textContent);

        let count = 0;
        Array.from(searchpop).forEach(element => {
            // console.log(element.textContent);

            let cardn = document.querySelector(`.card${count}`);
            let box = document.querySelector(`.box${count}`);

            let Serieshere = cardn.textContent;
            Serieshere = Serieshere.toLowerCase();

            // console.log(Animehere);
            // console.log(count);

            if (Serieshere == searchval || Serieshere.slice(0, searchval.length) == searchval) {
                box.style.display = "";
            }
            else {
                box.style.display = "none";
            }

            count++;
        })
    })



    searchbtn.addEventListener("click", function (event) {
        event.preventDefault();
        let finalinp = search.value;
        // console.log(finalinp);

        let count = 0;
        more = document.getElementsByClassName('more');
        Array.from(more).forEach(element => {
            let Sname = element.textContent;

            curclass = document.querySelector(`.S${count}`);
            // console.log(curclass);

            Sname = Sname.toLowerCase();
            finalinp = finalinp.toLowerCase();
            finalinpsize = finalinp.length;

            if (Sname == finalinp || Sname.slice(0, finalinpsize) == finalinp) {
                // console.log("yahooo");
                curclass.style.display = "";
            }
            // else if (Sname != finalinp) {
            //     console.log((Sname.slice(0,2)));
            //     if ((Sname.slice(0,2)).includes(finalinp)) {
            //         curclass.style.display = "";
            //     }
            //     else {
            //         curclass.style.display = "none";
            //     }
            // }
            else if ((Sname.includes(finalinp)) && (finalinp.length > 4)) {
                curclass.style.display = "";
            }
            else {
                // console.log("nopes");
                curclass.style.display = "none";
            }
            count++;
        });

    })
</script> -->
{% endblock%}